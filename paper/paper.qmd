---
title: "Fire Safety Regulation Violations in Toronto Residential Properties: Analysis by Property Type and Inspection Duration"
subtitle: "High Probability of Violations Across Most Properties, with High-Rise Buildings, Rooming Houses, and Group Homes Exhibiting the Highest Risk"
author: 
  - Yunkai Gu
thanks: "Code and data are available at: [https://github.com/Kylie309/Toronto-Fire-Inspection](https://github.com/Kylie309/Toronto-Fire-Inspection)."
date: today
date-format: long
abstract: "This paper analyzes fire safety regulation violations in residential properties across Toronto, predicting the likelihood of violations based on the inspection duration and property type, using data from fire safety inspections ended during 2024. By using a Bayesian logistic regression model, the study finds that property type plays a significant role in predicting violations, with high-rise buildings, rooming houses, and group homes at higher risk, and predicts with high confidence that most properties in the city would have a high probability of being observed to have a violation of fire safety regulations. These findings are important for improving fire safety protocols, as they suggest that targeting inspections towards high-risk property types could lead to more effective resource allocation and better safety outcomes. Findings in the study would motivate targeted inspections and interventions concentrated on properties that present the greatest risk, enhancing the effectiveness of fire safety efforts and helping to reduce potential fire accidents more efficiently."
format: pdf
number-sections: true
toc: true
prefer-html: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

# Workspace setup
library(tidyverse)
library(janitor)
library(lubridate)
library(modelsummary)
library(rstanarm)
library(ggplot2)
library(arrow)
library(knitr)
library(kableExtra)
library(RColorBrewer)
library(broom)
library(broom.mixed)

# Read the cleaned data
cleaned_data <- read_parquet(
  file = here::here("data/02-analysis_data/fire_cleaned_data.parquet")
  )
```


# Introduction

In recent years, fire safety inspections in residential buildings have gained increasing attention from the public due to their role in ensuring the safety of residents and reducing the risks of fire-related accidents. Toronto Fire Services (TFS) fire prevention and enforcement strategies, which are guided by the Fire Protection and Prevention Act, 1997 (FPPA) and regulations under it (such as Ontario Fire Code), aim to enhance public safety and awareness [@fire_info].

In order to achieve this goal, TFS has been conducting inspections across a wide range of residential properties throughout the city to ensure properties' compliance with fire safety regulations. However, despite these efforts, there remains limited understanding of the factors influencing the likelihood of fire safety violations across different property types and inspection duration. As a result, targeted interventions have not been effectively implemented for high-risk buildings. Therefore, this paper aims to analyze the impact of both inspection duration and property type on the likelihood of violations during fire safety checks. By doing so, the study aims to develop a model that provides predictions of violations based on specific features of the properties and inspection characteristics, thereby improving TFS's ability to prioritize resources and focus on properties that require the most attention.

The focus of this study is to investigate how different property types and inspection duration contribute to fire safety violations in Toronto, using a Bayesian logistics regression model to conduct predictions. The predictor variables examined include the time interval of the inspection process, and the type of property being inspected. By exploring these factors, the paper aims to predict the likelihood of violations, conducting predictions of which property types are at higher risk for violations and how inspection duration might influence these outcomes. The estimand is described in detail in @sec-estimand.

As included at the end of the analysis, the model indicates that the duration of the inspection has a negligible impact on the likelihood of violations, while the variable of property type is a more significant predictor of likelihood of violations. The model predicts with high confidence that most properties would have a high probability of being observed to have a violation of fire safety regulations. This confident prediction highlights the utility of the model in identifying properties at high risk for violations, helping to conduct targeted inspections and interventions where they are most needed. Moreover, the analysis further suggests that different property types have varying impacts on the likelihood of fire safety violations. The model confidently predicts that among ten property types inspected, "High Rise," "Rooming House," and "Group Home" are more likely to have violations. As a result, these property types should receive more targeted inspections and interventions. Along with "Low Rise" and "Hotel & Motel," these property types show strong evidence of being associated with higher risks of violations. In contrast, the model indicates that "Nursing Home" has the lowest risk of violations among the ten property types inspected, with some uncertainty regarding the strength of this predicted relationship.

This research contributes to improving fire safety facilities in residential buildings in Toronto by providing empirical evidence and statistical predictions that supports the allocation of inspection resources based on both the property type and inspection duration. By highlighting which property types with how long inspection duration are most at risk for fire safety violations, the findings offer a valuable approach to prioritizing inspections and interventions. The results of the study have broader implications for fire safety policy, as they could be used to improve future regulatory practices and resource allocation strategies. By ensuring that inspection resources are concentrated on properties that present the greatest risk, this study would enhance the effectiveness of fire safety efforts, and help to reduce the risk of fire accidents more efficiently.

The remainder of this paper is structured as follows: 

@sec-data introduces the overview of the data (@sec-data-overview) and measurement (@sec-data-measure), as well as explanations, descriptions, table and graph summaries of outcome (@sec-data-outcome) and predictor variables (@sec-data-predictor) of the study. @sec-model explains the modeling process in detail, including procedure of model set-up (@sec-model-set), model assumptions and limitations (@sec-model-assume), and model justification (@sec-model-justify). Then, @sec-result presents the model outcome and results by tables and plots, and @sec-discussion discusses the study in a broader context. 

Appendix includes three parts:[Appendix -@sec-appx-survey] describes detailed idealized sampling methodology and survey designed for residents to collect fire safety feedback; [Appendix -@sec-appx-data] provides additional data details in data cleaning process; [Appendix -@sec-model-details] presents additional details during modeling process, including posterior predictive check [Appendix -@sec-ppc], comparison between posterior and prior distributions [Appendix -@sec-pvp], and diagnostics [Appendix -@sec-diagnostics].



## Estimand {#sec-estimand}

The estimand in this paper is the probability of a fire safety violation occurring in residential properties in Toronto, based on two primary factors: inspection duration (measured as the time interval between the start and end of the inspection process) and property type (such as high-rise, low-rise, group home, etc., a total of ten types). The goal of the analysis is to evaluate how these factors influence the likelihood of a violation being detected during fire safety inspections.

Specifically, the estimand is modeled as the probability that a property will fail the fire safety inspection (i.e., a violation is found) based on these two predictors. The response variable is binary: a violation is either observed (1) or not observed (0). This probability is expressed as a function of the inspection time interval and the property type, with the logistic regression model used to predict the outcome, estimating the log-odds of a violation for different values of these predictors.

The estimand, therefore, directly addresses the question: "What is the likelihood of a violation being observed during the inspection process for a given property, based on its property type and the duration of the inspection?" By understanding the prediction results of the study, identifying which properties are at higher risk of violations would be possible, and the conclusions could be used for guiding TFS to conduct more targeted inspections and interventions to residential properties.



# Data {#sec-data}

## Overview {#sec-data-overview}

This paper uses Highrise Residential Fire Inspection Results dataset obtained from Open Data Toronto as the main source of data [@fire_data]. The portal is launched by City of Toronto to meet growing demand for open data. The raw dataset presents information of properties where Inspectors from Toronto Fire Services (TFS) have examined on, as well as whether the properties violated fire safety regulations and the details of violations if so.

Note that though the dataset named "Highrise" Residential Fire Inspection Results, expansion work completed in 2020 has allowed for inspection results for more prperty types to be presented in the dataset. The portal now not only shows residential high-rise buildings, but also shows "inspection matters for multi-unit residential occupancy types including high-rise, low-rise, small multi-unit buildings, rooming houses/group homes, hotels, motels, detention centres, and all applicable vulnerable occupancy buildings (hospitals, nursing homes, residential cares and group homes designated a VO)" [@fire_info].

To ensure the analysis presented in this paper remains relevant and current, only inspection cases that have concluded their inspection files or enforcement proceedings within the year 2024 are selected. This is achieved by filtering the dataset to keep only rows where the 'INSPECTIONS_CLOSEDDATE' column displays a date that falls within the year 2024. This approach ensures that the data reflects the most recent developments, providing an up-to-date basis for analysis and maintaining a clear and accurate representation of the latest trends and outcomes in fire safety checks. 

@tbl-overview presents several sample lines of the cleaned dataset. More detailed data cleaning process is included in [Appendix -@sec-appx-data]. 

```{r}
#| echo: false
#| eval: true
#| label: tbl-overview
#| tbl-cap: "Preview of the Cleaned Dataset"
#| warning: false

cleaned_data |>
  head() |>
  kable(format = "simple")
```

The analyses presented in this paper were conducted using R programming language [@citeR]. The `tidyverse` packages [@citetidyverse] were used in the process of data simulation, testing and downloading. After the original raw data was successfully downloaded, data cleaning process was done by using `tidyverse` package [@citetidyverse], `lubridate` package [@citelubridate], `janitor` package [@citejanitor] and `dplyr` package [@citedplyr]. The analysis dataset after cleaning is saved as a parquet file using `arrow` package [@citearrow].

Then, models were constructed using `tidyverse` package [@citetidyverse], `lubridate` package [@citelubridate] and `rstanarm` [@citerstanarm] package. The model results were then presented by both the tables and graphs. Tables were made with `modelsummary` [@citemodelsummary] package, `broom.mixed` package [@citebroom], `dplyr` package [@citedplyr], `knitr` package [@citeknitr] and `kableExtra` package [@citekableextra]. Graphs were made with `ggplot2` package [@citeggplot].

Following @tellingstories, this paper uses Bayesian modeling to predict the pass or fail status for safety checks of the properties in Toronto. The factors of region, property type and inspection time intervals from the dataset are mainly chosen and considered to examine their effects on the likelihood of violations for the properties.



## Measurement {#sec-data-measure}
	
The dataset captures data related to the results of fire safety inspections conducted by Toronto Fire Services (TFS) in residential buildings in Toronto, which is guided by the Fire Protection and Prevention Act, 1997 (FPPA) and regulations under the FPPA, like the Ontario Fire Code [@fire_info]. It includes information on properties where violations have been found by inspectors from TFS and required to correction to comply with the Ontario Fire Code at the time, as well as properties with no observable violations [@fire_data].

The data collection process was conducted by TFS Fire Inspectors. Inspectors assess tangible aspects of fire safety based on observable and measurable attributes of the physical environment within the properties. This includes evaluating factors such as proper storage of combustible materials, the functionality of fire alarms and fire pumps, the maintenance records for fire safety equipment and so on, all in accordance with the regulations under FPPA. 

After the inspections were completed, the observations have been translated into records and written into collected data. The raw data provided by Open Data Toronto includes three main aspects: property identifier (such as address, property type), inspection information (such as inspection start and end dates), and inspection outcomes (pass or fail status for safety checks, and details of violations). 

Note that this dataset only includes 'closed' cases, referring to those whose inspection processes have been completed. The ongoing inspections are not presented in the dataset, which may result in a potential loss of information. This limitation would be further discussed in detail in the @sec-discussion.



## Outcome Variable {#sec-data-outcome}

### Violation

The outcome variable for the model is the violation status of the properties. In other words, it is the variable that represents whether the properties inspected were found to be in violation of fire safety regulations by a TFS Inspector.

In the raw dataset, columns 'VIOLATION_FIRE_CODE', 'VIOLATION_DESCRIPTION' and 'VIOLATIONS_ITEM_NUMBER' indicate the outcome of the inspections. The first two columns provide detailed information about the fire code under which violation was noted, while the latter presents the order number of violations by code and shows 0 if no violations were observed.

To simplify the analysis, a new column, 'violation', is created. This column contains binary values, with 1 indicating that a violation was observed and 0 indicating no violation. Thus, the outcome variable is binary.

```{r}
#| label: fig-violation
#| fig-cap: Counts of Properties with Violations versus Those without
#| echo: false
#| warning: false
#| message: false

cleaned_data |>
  ggplot(aes(x = as.factor(violation), fill = as.factor(violation))) +
  geom_bar(color = "black") +
  labs(
    x = "Violation Status",
    y = "Counts",
    fill = "Violation Status" # Legend title
  ) +
  scale_fill_manual(
    values = c("skyblue", "orange"),
    labels = c("No Violation Observed (Denoted as 0)", "Violation Observed (Denoted as 1)")
    ) + 
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    axis.text = element_text(size = 10),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )
```


@fig-violation displays the visualized counts of properties with violations versus those without. The height of each bar shows the total number of cases corresponding to each category. The orange bar is significantly taller, indicating that among all cases selected for analysis, violations were reported more frequently in the dataset (9,829 cases out of 13,193). In contrast, the blue bar is shorter, reflecting fewer cases without violations (3,364 cases out of 13,193). 

The data contains a higher number of cases with violations (1) compared to those where no violations were observed (0), suggesting that violations are relatively common.



## Predictor Variables {#sec-data-predictor}

### Inspection Duration

One predictor included in the model is the inspection duration. It refers to the time interval between the start and end of the fire inspections conducted by the TFS inspectors for each case.

In the raw dataset, there are two columns recording the dates: 'INSPECTIONS_OPENDATE' and 'INSPECTIONS_CLOSEDDATE'. The former represents the date TFS opened the inspection file, while the latter denotes the date TFS closed inspection file or the date enforcement proceedings ended (whichever is later). 

During the data cleaning process, these dates are converted into time interval to enable easier analysis. A new column, 'date_num', was created by calculating the time difference between the end and start times of the inspection, in the unit of days.

```{r}
#| label: fig-date
#| fig-cap: Distribution of Inspection Duration
#| echo: false
#| warning: false
#| message: false

cleaned_data |> 
  ggplot(aes(x = date_num)) + 
  geom_histogram(fill = "skyblue", color = "black", alpha = 0.7) +
  labs(x = "Inspection Duration (Days)",
       y = "Counts") +
  theme_minimal()
```


@fig-date illustrates the distribution of inspection duration. The X-axis represents the number of days for each inspection case, while the Y-axis represents the counts. The distribution peaks at low intervals, with the highest bar near 0 days, indicating that a large number of properties have very short inspection time intervals. The right-skewed shape of the distribution suggests that as the inspection duration increases, the counts of cases decrease stably. The long tail on the right side of the distribution means that there also exist cases with very long duration in the dataset, extending up to 1,500 days or more.



### Property Type

The second predictor variable in the model is property type. It refers to the occupancy type of the property where the inspection took place. This variable is directly included in the raw dataset.

To visualize the distribution of property types, two bar plots are created separately in @fig-type. The left panel presents the number of occurrences of "High Rise" and "Low Rise" properties, with the bar representing "High Rise" relatively taller, indicating a higher count compared to "Low Rise." This suggests that the inspection results and data collection focus more heavily on high-rise buildings.

The right panel displays the other categories of properties, including "Detention," "Group Home," "Group Home (VO)," "Hospital," "Hotel & Motel," "Nursing Home," "Residential Care," and "Rooming House." The "Rooming House" category has the highest count among these property types, while categories of "Detention" and "Group Home" have relatively lower counts, suggesting that they are less represented in the dataset. 

In general, the distribution of the property types is diverse, with some types being far less frequent than others. High-rise properties dominate the dataset, while rooming houses are the most frequent within other categories. This pattern may indicate an emphasis on inspecting high-rise buildings and rooming houses than those of other property types.

```{r}
#| label: fig-type
#| fig-cap: Distribution of Property Types
#| echo: false
#| warning: false
#| message: false
#| fig-subcap: ["High Rise versus Low Rise", "Other Types"]
#| layout-ncol: 2

data_rise <- cleaned_data %>% 
  filter(property_type == "High Rise" | property_type == "Low Rise")

data_other <- cleaned_data %>% 
  filter(property_type != "High Rise" & property_type != "Low Rise")

# Create bar plot for high rise properties versus low rise properties
data_rise |>
  ggplot(
    aes(x = as.factor(property_type), 
        fill = as.factor(property_type))
    ) +
  geom_bar(color = "black") +
  labs(
    x = "Property Type",
    y = "Counts",
    fill = "Property Type"
  ) +
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1), 
    axis.text.y = element_text(size = 10),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )

# Create bar plot for other property types
data_other |>
  ggplot(
    aes(x = as.factor(property_type), 
        fill = as.factor(property_type))
    ) +
  geom_bar(color = "black") +
  labs(
    x = "Property Type",
    y = "Counts",
    fill = "Property Type" 
  ) +
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1), 
    axis.text.y = element_text(size = 10),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )
```



## Violation by Property Type

@fig-violationbytype displays faceted bar plots illustrating the distribution of violation statuses (0 for no violation, 1 for violation) across different property types. Each subplot represents a different property type.

In general, the property types of "Group Home," "High Rise," "Low Rise," and "Rooming House" show a higher proportion of violations (1). The type "Hotel & Motel" has relatively balanced counts between 0 and 1, but violations (1) are slightly more frequent. These property types may require more attention or stricter inspections.

On the other hand, other property types, especially "Detention" and "Nursing Home," show a much lower proportion of violations, suggesting a lower relative violation rate.

```{r}
#| label: fig-violationbytype
#| fig-cap: Violation Status by Property Type
#| echo: false
#| warning: false
#| message: false


cleaned_data |> 
  ggplot(aes(x = as.factor(violation), fill = as.factor(violation))) +
  geom_bar(color = "black") +
  facet_wrap(~ property_type, scales = "free_y") + # Create one subplot per property type
  labs(
    x = "Violation Status",
    y = "Counts",
    fill = "Violation Status"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_blank(), 
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    strip.text = element_text(size = 8), 
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10),
    panel.spacing = unit(1, "lines")
  ) +
  scale_fill_manual(values = c("skyblue", "orange"))
```



# Model {#sec-model}

The goal of the modelling strategy is twofold. 

Firstly and most importantly, from a statistical perspective, the goal is to estimate the detection of violations during an inspection based on the time interval and property type. 

Secondly, from a more practical standpoint, by predicting which property types and inspection duration are more likely to result in violations, a more efficient inspection process could be developed. Identifying certain property types that have high risk to violate the fire safety regulations could provide guidelines for interventions and support implementation of targeted and focused actions.

The model presented in the paper is Bayesian logistics regression model designed to predict the violation status (denoted as 'violation') based on the fixed effects of inspection duration (denoted as 'date') and property type (denoted as 'type'). It is designed to forecast the inspection results based on these two predictor variables.

The following sections define, explain and justify the model and its variables. They also discuss underlying assumptions, potential limitations, the software used for implementation, and provide evidence of model validation and checking.

Background details and diagnostics of the model are included in [Appendix -@sec-model-details].



## Model set-up {#sec-model-set}

The Bayesian model was implemented using the R programming language [@citeR], specifically utilizing the `rstanarm` package by @citerstanarm. This package provides an interface for fitting Bayesian regression models using Stan, and the models are fit using its functionality.

Define $y_i$ as the binary response variable for observation $i$. $y_i=1$ indicates that a violation has been observed, while $y_i=0$ indicates that no violation occurs. This follows a Bernoulli distribution:

$$y_i=\text{Bernoulli}(p_i)$$

where $p_i$ is the probability of a property that is observed to have violations of fire safety regulations.

Then define the inspection time interval for observation $i$ as 'date' and the property type as 'type'.

The Bayesian model could be expressed with the following mathematical formulations:


\begin{align} 
\text{logit}(p_i) = \beta_0 + \beta_1 \cdot \text{date}_i + \beta_2 \cdot \text{type}_i \\
\text{logit}(p_i) = \log\left(\frac{p_i}{1 - p_i}\right) \\
\beta_0 \sim \mbox{Normal}(0, 2.5) \\
\beta_1 \sim \mbox{Normal}(0, 2.5) \\
\beta_2 \sim \mbox{Normal}(0, 2.5)
\end{align}


where:

- $\text{logit}(p_i) = \log\left(\frac{p_i}{1 - p_i}\right)$ represents the log-odds of $p_i$.
- $\beta_0$ is the intercept term of the Bayesian logistic regression, representing the baseline log-odds of a violation when $\text{date} = 0$ and 'type' is the reference category. Formula (2) specifies that $\beta_0$ follows normal distribution with a mean of 0 and a variance of $2.5^2$.
- $\beta_1$ is the coefficient for predictor variable 'date', representing the change in log-odds of a violation for per unit increase in 'date', i.e., the inspection time interval. Formula (3) specifies that $\beta_1$ follows normal distribution with a mean of 0 and a variance of $2.5^2$.
- $\beta_2$ is the coefficient for the predictor variable 'type', representing the change in log-odds of a violation for each unit increase in 'type'. Formula (4) specifies that $\beta_2$ follows normal distribution with a mean of 0 and a variance of $2.5^2$.

Formula (2), (3) and (4) specifies priors for the model. These priors reflect the assumption that the coefficients are centered around 0, with a standard deviation of 2.5, allowing for moderate variability while discouraging extreme values.



## Model Assumptions {#sec-model-assume}

The main assumptions for the Bayesian model and situations where the model may not be appropriate are discussed below. Limitations of the model are covered in detail in @sec-limit.

- Independence of Observations

Firstly, the model assumes that each observation is independent of others. This assumption suggests that violations at one property should not influence violations at another property, unless explicitly modeled (e.g., through random effects).

If observations are clustered (e.g., multiple observations in the same region or by the same inspector were recorded in the dataset), this assumption may be violated, leading to potential overestimation or underestimation of standard errors and outcomes.

- Linearity in the Logit

Secondly, the model assumes linearity in the logit. This assumption states that the log-odds of the response variable ($\text{logit}(p_i)$) are a linear function of the predictors.

If violations change in a non-linear manner over time, this model assumption would be violated, potentially resulting in misfit of the model.

- Prior Distributions

Thirdly, the model assumes priors of $\text{Norma}(0,2.5)$ for the coefficients, based on domain knowledge. Poorly chosen priors could introduce bias into the estimation results.

Also, if new levels of property type ('type') levels are introduced, the model may be no longer suitable for the new situation, as fixed effects may not be feasible for estimating the new categories. In such cases, random effects might be a more appropriate alternative.



## Model Justification {#sec-model-justify}

Since the response variable is binary for each case and follows a Bernoulli distribution, a Bayesian logistic regression model is appropriate for estimating it. 

The predictor variable of inspection duration ('date') is modeled as a fixed effect in the model. There are several reasons for this choice. Firstly, 'date' represents the number of days on which the inspection processed, making it a numeric variable. Modeling it as a fixed effect allows the model to estimate its direct, continuous influence on the response variable. Secondly, since 'date' applies across all observations regardless of property type, modeling it as a fixed effect allows its impact to be considered consistently across the entire dataset. This also makes the coefficient of 'date' ($beta_1$) be easier to interpret and avoids adding unnecessary complexity to the model.

The other predictor variable, property type ('type'), is also modeled as a fixed effect. Since it is categorical variable, modeling it as a fixed effect enables the model to estimate a separate coefficient for each category, relative to the reference level. This makes it easier to compare different property types, in order to understand which types of properties are more likely to have violations. Moreover, since 'property_type' has only 10 levels, it is feasible to compute it as a fixed effect and develop estimation without overloading the model. 

The prior of $\mbox{Normal}(0, 2.5)$ for each coefficient is reasonable because it reflects prior knowledge that most predictors have small-to-moderate effects on the log-odds scale. This assumption helps prevent overfitting by discouraging extreme values.

The final model choice was made after considering several alternative models. One alternative is a simple linear regression (SLR) model, which assumes a constant linear relationship between the predictor (violation) and the response (date). While straightforward and easy to interpret, this model is too simplistic for estimation, neglecting the important variable of property type (type). More importantly, the response variable is binary, and SLR assumes a continuous response, making it unsuitable for this case. Multiple linear regression (MLR) also assumes a continuous response variable, so it was similarly rejected.

Another alternative considered was a Bayesian model with natural splines (e.g. $f(\text{date}_i)$), which could model complex, non-linear time trends and would be appropriate for 'date'. However, the expected model for this study does not primarily focus on exploratory analysis on non-linear relationships between 'date' and 'violation'. Non-linear functions would also overfit the data if not regularized properly. 

Additionally, a Bayesian logistic model with property type ('type') as a random effect was considered. This would capture variability across property types without explicitly estimating coefficients for each type. While this model would be suitable if there were many property types, it was unnecessary given the manageable number of property types in this case.

Therefore, after considering these alternatives, the final model of Bayesian logistics model with inspection duration ('date') and property type ('type') as fixed effects was chosen. This model allows for direct, explicit comparisons between property types without overfitting the model, and aligns with the focus of the research question.



# Results {#sec-result}

## Model Summary

The results of the Bayesian logistic regression model are summarized in @tbl-modelresults. The table provides information about the coefficients and main summary statistics.

The table firstly lists estimates of coefficients for all parameters. The first line suggests an intercept of -6.72 for the model, indicating very low baseline odds of a violation for the reference property type when $\text{date} = 0$. The second line shows that the estimated coefficient for predictor 'date' is 0.02, which is very small and suggests that the inspection duration has a negligible effect on the violation outcome of observations.

The table then presents the coefficients for every property type respectively. All property types show large positive coefficients, meaning that they increase the log-odds of violations and have a higher risk of violation compared to the reference property type. For example, for the property type of "Group Home", the log-odds of violation increases by 5.88; for the property type of "High Rise", the increase is 6.21; for the property type of "Hospital", the increase is 4.67; and so on. It could be observed that "Nursing Home" has the smallest coefficient, suggesting that it has the smallest effect on the likelihood of violations. However, it still contributes positively to the log-odds of a violation.

The table also presents summary statistics of the model. One of the important results is $R^2=0.342$. $R^2$ refers to the proportion of the variation in the dependent variable that is predictable from the independent variables [@wiki_rsquare]. An R-squared value of 0.342 suggests that 34.2% of the variability in the response variable ('violation') is explained by the model, which is relatively good for logistic regression. Moreover, the RMSE (Root Mean Squared Error) value of 0.32 indicates the average deviation between predicted probabilities and observed outcomes. This value is low, suggests a satisfactory fit for the model.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

model <-
  readRDS(file = here::here("models/violation_prediction_model.rds"))
```

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory Model of Probability of Violation based on Inspection Duration and Property Type"
#| warning: false

modelsummary::modelsummary(
  list(
    "Model" = model
  ),
  statistic = "mad",
  fmt = 2
)
```



## Posterior Parameter Estimates

@tbl-posteriorestimate shows more detailed information about the coefficients of each parameter. The "Estimate" column presents the mean posterior estimate for the effect of each parameter on the log-odds of the outcome ('violation'); The "Std.Error" column presents the standard deviation, or the uncertainty, in the estimate; The "Conf.Low" column and the "Conf.High" column present the lower and upper bounds of the 95% credible interval for the parameter, illustrating the range of plausible values for the effect of the parameter.

```{r}
#| echo: false
#| eval: true
#| label: tbl-posteriorestimate
#| tbl-cap: "Posterior Parameter Estimates"
#| warning: false

# Summarize the Bayesian model
summary_stats <- summary(model)

# Use `tidy()` for a clean tabular format
tidy_stats <- tidy(model, conf.int = TRUE)

# Round all numeric columns to 3 decimal places
tidy_stats <- tidy_stats %>%
  mutate(across(where(is.numeric), ~ round(., 3)))

# Create a table of parameter estimates
tidy_stats %>%
  kable(format = "simple", col.names = c("Parameter", "Estimate", "Std.Error", "Conf.Low", "Conf.High"))

```


The main interpretation for the code focuses on the 95% confidence interval. In general, if the credible interval does not include 0, the effect of the variable is considered statistically significant, indicating that the model is confident in the relationship. Most of the parameters have credible intervals that exclude 0, with some intervals being far from 0, suggesting that there is strong evidence supporting their effect on the violation outcome. For example, the property type of "High Rise" has a 95% CI of $[3.25, 10.45]$, showing that the model is confident in the significant effect of high-rise buildings on the log-odds of violations, with a substantial contribution to the likelihood of violations.

On the other hand, two parameters have 95% CI that includes 0, which are property types of "Group Home (VO)" and "Nursing Home". This represents that the effect of these variables on violations is not statistically significant, and the relationship remains uncertain. Further data collection may be necessary to better understand their relationships with violations.

@fig-95ci visualizes the parameter estimate values and their credible intervals for clearer presentation.

```{r}
#| label: fig-95ci
#| fig-cap: Parameter Estimates with 95% Credible Intervals
#| echo: false
#| warning: false
#| message: false

tidy_stats |>
  ggplot(aes(x = term, y = estimate)) +
  geom_point(size = 3, color = "red") +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2) +
  coord_flip() +
  labs(y = "Log-Odds Estimate",
       x = "Parameter") +
  theme_minimal()
```



## Distribution of Predicted Probabilities

@fig-predictprob plots the distribution of predicted probabilities for the model. The X-axis represents the predicted probabilities ($p_i$) of the outcome for each observation in the dataset, with values ranging from 0 to 1. The Y-axis represents the relative density of observations with particular predicted probabilities. The density curve on the graph represents the estimated density of predicted probabilities, and the curve's height reflects how concentrated the predicted probabilities are around specific values.

In general, the distribution shown by the plot has two peaks near 0 and 1, with very few probabilities in the intermediate range (0.25–0.75). This is a bimodal distribution, meaning that most observations are confidently predicted to either not have a violation ($p\approx0$) or have a violation ($p\approx1$). The sparse region in the intermediate range suggests that the model is making confident predictions, with minimal uncertainty for most observations.

The plot shows that the distribution has higher peak, which means a higher density, around $p=1$. On the other hand, the peak around $p = 0$ is slightly lower. This indicates more confident predictions for observations with a high probability of violations, meaning that the model predicts a larger proportion of observations with high confidence that a violation is likely to occur.

Therefore, the conclusion drawn from the graph is that: more observations are predicted to have a high probability (mostly $p>0.9$) of being observed to have a violation.

```{r}
#| label: fig-predictprob
#| fig-cap: Distribution of Predicted Probabilities
#| echo: false
#| warning: false
#| message: false

# Generate predicted probabilities
predicted_probs <- posterior_predict(model)

# Visualize predicted probabilities
ggplot(
  data = data.frame(predicted_probs = as.vector(predicted_probs)), 
  aes(x = predicted_probs)
  ) +
  geom_density(fill = "blue", alpha = 0.5) +
  labs(x = "Predicted Probability",
       y = "Density") +
  theme_minimal()
```



## Conclusion

The results of the Bayesian logistic regression model indicate that the duration of the inspection has a negligible impact on the likelihood of violations, while the variable of property type is a more significant predictor of likelihood of violations. The model predicts with high confidence that most properties would have a high probability of being observed to have a violation of fire safety regulations, shown by the distribution of predicted probabilities. This confident prediction highlights the utility of the model in identifying properties at high risk for violations, helping to conduct targeted inspections and interventions where they are most needed.

The analysis further highlights that property types have varying impacts on the likelihood of fire safety violations. Among the property types, "High Rise," "Rooming House," and "Group Home" have the highest risk of violations compared to the reference property type, as evidenced by the large, positive coefficients. These property types are followed by "Low Rise" and "Hotel & Motel," which also show relatively high risks of violations. For these five property types, there is strong evidence supporting their relationship with the likelihood of violations, as their 95% credible intervals do not include zero, suggesting a statistically significant impact. 

On the other hand, "Nursing Home" shows the smallest coefficient, with CI including zero. This suggests a relatively lowest risk of violations and some uncertainty regarding the strength of the relationship. Despite this, "Nursing Home" still demonstrates a positive, though weaker, risk of violations compared to other property types.



# Discussion {#sec-discussion}

## Overview of the Paper 

This paper investigates the factors that influence fire safety violations in residential buildings in Toronto, with a particular focus on the role of property type and inspection duration. The central aim is to predict the likelihood of violations, conducting predictions of which property types are at higher risk for violations and how inspection duration might influence these outcomes. The paper uses a Bayesian logistic regression model to analyze data from properties that underwent fire safety inspections by Toronto Fire Services (TFS). The raw dataset is obtained from Open Data Toronto, and a data cleaning process is performed to retain only inspection cases with a closed date within 2024, ensuring that the data reflects the most recent developments and provides an up-to-date basis for analysis. By focusing on the inspection outcomes of the properties where the inspection process was completed in 2024, the study uses a binary outcome variable to indicate whether a violation was observed (1) or not observed (0), facilitating a clear distinction between properties that violated fire safety regulations and those that did not.

The analysis includes two main predictor variables: the inspection duration and property type. The inspection duration refers to the time interval between the start and end date of the inspection, and property type includes ten categories, such as high-rise buildings, low-rise buildings, group homes, and others. These two variables were selected based on their potential to influence the outcome of fire safety inspections. The inspection duration was expected to be a relevant predictor since longer inspections might allow for more thorough checks, potentially leading to more cases with violations being detected. Similarly, different property types were assumed to have varying levels of probability of violating fire safety regulations, as the unique features and characteristics of the occupancy types may lead to more or less additional safety concerns.

The study employs a Bayesian logistic regression model to analyze the data, allowing for the prediction of the likelihood of violations while considering uncertainty around the estimates at the same time. The results of the model are stated as follows: the model predicts with high confidence that most properties would have a high probability of being observed to have a violation of fire safety regulations; Different property types have varying impacts on the likelihood of fire safety violations; Duration of the inspection has a negligible impact on the likelihood of violations; Among ten property types inspected, "High Rise," "Rooming House," and "Group Home" are more likely to have violations, suggesting that these property types should receive more targeted inspections and interventions.

Overall, the paper identifies the role of property type as a key factor influencing fire safety regulation violation status in Toronto. The findings of the study could then be used to motivate targeted inspections and interventions, enabling fire prevention resources to be concentrated on properties that present the highest risk. Prioritizing high-risk buildings enhances the effectiveness of fire safety efforts, and helps to reduce the likelihood of fire accidents more efficiently.



## Varying Possibility of Violation for Different Property Types

One of the key lessons from this study is that property type plays an important role in determining the likelihood of fire safety violations. The findings show that property types of high-rise buildings, group homes, and rooming houses have a significantly higher possibility of violations compared to other types. This finding highlights the importance of property characteristics in influencing fire safety outcomes, rather than assuming all properties face the same risks.

In the real world, such result could assist Toronto Fire Services and other fire safety authorities in prioritizing their efforts and allocating the fire prevention resources more efficiently. Properties with higher risk of violation would require more frequent, careful and thorough inspections, as well as more targeted fire safety interventions. For instance, high-rise buildings typically have more complex layouts and higher occupancy, presenting unique fire safety challenges. One example of such difficulties is that extra actions would be needed to ensure that fire safety measures are effective across multiple floors. Authorities could focus on addressing these challenges by conducting more frequent maintenance of fire safety equipment, such as alarms, sprinklers, and fire exits, testing that they are functioning properly throughout the building, and implementing enhanced systems preventing fire accidents. 

By focusing on high-risk property types, Toronto Fire Services could allocate resources more effectively, ensuring that inspections are concentrated in areas where they are most needed. This would help protect the residents living in those properties from fire-related dangers. Additionally, this targeted approach would motivate the city to consider fire safety regulations targeted specifically to these property types. Furthermore, there is potential to arise the residents' awareness of fire safety issues, encouraging greater public attention to fire prevention. This heightened awareness could lead to more voluntary fire safety practices, both within buildings and in the community, reducing the risk of fire-related incidents across Toronto.



## Limited Role of Inspection Duration in Predicting Violations

Another key learning from this paper is that inspection duration — the time interval between the start date and the closed date of the inspection — does not significantly affect the likelihood of fire safety violations found in properties. While it is expected that longer inspections lead to more thorough checks and thus a higher probability of identifying violations, the findings of this study challenge this idea. The study suggests that the duration of the inspection has a negligible impact on the detection of violations.

In practical terms, this finding is valuable for fire safety management and resource allocation. Toronto Fire Services may reconsider the emphasis placed on inspection duration. If longer inspections are not significantly improving the detection of violations, resources could be better spent on other aspects of the inspection process, such as using high-quality fire safety technologies, improving inspector training, or focusing on properties with higher violation risks. This could make the inspection process be more cost-effective by reducing the time spent on inspections, while still maintaining the quality of fire safety prevention procedure.

As stated before, the study’s findings further suggest that the key to effective fire safety inspections lies in targeting high-risk properties rather than increasing inspection time. Fire safety inspections could be made more efficient by focusing on properties with higher violation risks, based on their property type or past inspection records. This targeted approach could lead to better outcomes, encouraging fire safety authorities to shift their focus from inspection duration to more strategic inspection methodologies.



## Weaknesses and Limitations {#sec-limit}

The limitations in the process of measurement of the original dataset should be considered. Specifically, the limitations include:

- Observer Bias

Although inspectors conduct the violation detection procedure in reference to the same, standardized fire safety regulations (Ontario Fire Code, FPPA and Municipal Code, according to City of Toronto) to ensure consistency, their subjective judgment could still play a significant role in the examination process. 

Various interpretations of the guidelines and different decision-making procedures employed by the inspectors based on specific situations could impact the outcome of the inspection. The inspectors' focus during an inspection may vary depending on their experience, training, and individual judgment. Even though the examinations are conducted following clear rules, the outcomes of assessments could differ based on the inspectors' focus on certain regulations. As a result, the observations recorded during inspections might vary, introducing potential inconsistencies in how violations are identified. This variability could lead to differences in the recorded outcomes of inspections, impacting the reliability of the data.

- Data Completeness

The dataset does not capture all fire safety-related phenomena in Toronto, as it only contains the properties that have been inspected by the Inspectors from Toronto Fire Services. Properties that have not been inspected are not included in the dataset, meaning that there is no information available about their fire safety violation status. This limitation means that the dataset may not be fully representative of the overall fire safety situation across the city. Without data from properties that were not inspected, it is difficult to draw generalized conclusions about fire safety checks for the entire city, as the sample may be biased towards properties that have undergone inspection.

Moreover, even for the properties that have been inspected by TFS, not all cases are recorded in the dataset. The raw dataset only includes 'closed' cases, which are specific cases where the inspection process has ended. It does not account for cases currently under inspection or in progress, potentially leading to an incomplete picture of the fire safety status in Toronto.

In other words, the properties whose initial observations have been made but further investigation or corrective actions are required, are excluded from the dataset. Any ongoing cases, particularly those that are in the early stages of investigation, are not included. This could potentially lead to selection bias and skew the results. Therefore, the dataset fails to represent the full scope of fire safety checks at any given time. The active cases would be neglected in the analysis, providing limited basis to identify fire safety concerns in real-time.



## Future Steps

To further improve fire safety prevention and ensure more effective inspections, potential future research and action should be considered.

One key step for future research is try to include ongoing inspections and active enforcement cases in the analysis. The current study only took closed inspection cases into consideration, excluding properties still under review or those requiring further enforcement. This potentially introduces a selection bias. By including ongoing inspections and active cases, future studies could provide a more generalized view of fire safety violations for properties in Toronto, and further offer evaluation of how violations evolve over time. Potentially, examining the dates of inspections and corresponding outcomes could help understand whether certain time periods lead to higher rates of violation of fire safety regulations in residential properties.

While property type and inspection duration were the primary focus of this study, other factors which may contribute to the likelihood of fire safety violations should also be taken into consideration. Future research should include additional aspects and variables, such as building age, maintenance history, fire safety training for residents, and even fire department resources. For instance, older buildings or those with a history of poor maintenance may have larger possibility to be detected for violations. Another example is regional differences: Properties in certain areas of the city may face different fire safety challenges due to their geographic location or local regulations. Understanding these additional factors could help create a more complete model to predict fire safety violations and lead to more targeted inspection strategies.

After the inspection and enforcement process ends, Toronto Fire Services could also check the outcomes of fire safety inspections to obtain a general overview of the fire prevention status in the city. Including resident feedback through surveys or interviews could provide valuable insights into the effectiveness of fire safety inspections and regulations from the perspective of the people directly affected by these policies. Detailed idealized methodology would be further discussed in [Appendix -@sec-appx-survey]. Moreover, residents' awareness of fire safety could also be considered as an additional factor to be included in the model. Future research could examine how residents’ knowledge of fire safety regulations, their adherence to safety practices, and their willingness to report violations impact the likelihood of violations.

In conclusion, while this paper offers predictions and analysis of fire safety violations in Toronto, there are still many questions left to answer. By expanding the scope of the analysis by including additional variables, or possibly distributing surveys to the residents, future research could provide a more complete picture of fire safety status in the residential properties in the city. This will help fire safety authorities develop more targeted, efficient, and sustainable strategies for reducing violations, and ensuring the safety of residents.



\newpage

\appendix

# Appendix {-}

# Surveys, Sampling, and Observational Data {#sec-appx-survey}

## Overview of the Idealized Fire Safety Resident Survey

Fire safety inspections in residential buildings provide a mechanism for ensuring compliance with fire safety regulations. However, the dataset, which presents inspection outcomes and analysis, only reflects the violation status before the enforcement procedure ends. It fails to provide information about whether buildings will maintain compliance or revert to unsafe practices after the inspection process ends. Since frequent routine inspections are often expensive and therefore impractical, it is necessary to explore alternative methods for monitoring the fire safety status of properties and evaluating the long-term effectiveness of previous inspections.

Introducing a resident survey addresses such concerns by collecting the experiences and thoughts of those who are most directly affected by fire safety measures. Residents, who live in these buildings, are familiar with the day-to-day status of fire safety, and could provide honest feedback and valuable perspectives on whether inspections have led to improvements, or whether the properties have resumed practices that violate regulations. 

This approach not only offers real-time updates of the violation status of properties, but is also cost-effective. By incorporating resident surveys, the monitoring process becomes more sustainable, enhancing the overall understanding of fire safety compliance that extends beyond the inspection period.

The fire resident survey is designed to achieve the following objectives:

- Assess Perceived Changes After Inspections: Determine whether residents have noticed any improvements or changes in fire safety measures after the inspection and enforcement procedures, providing valuable feedback on the effectiveness of the inspections conducted.

- Identify Recurring Issues in Residential Buildings: Collect residents' observations and feedback on recurring violations of fire safety regulations in the properties, helping to highlight areas that may require further attention or action.

- Improve Policies Related to Fire Safety: Offer down-to-earth perspective from residents to improve regulatory practices related to fire safety, ensuring that policies aligned more closely with the needs and experiences of those directly affected. Such approach also guide more effective resource allocation to address ongoing safety concerns.

- Raise Residents' Awareness of Fire Safety: Determine whether residents are aware of fire safety inspections conducted in their buildings, and the extent to which they recognize the importance of fire safety. The survey, therefore, aims to emphasize that fire safety inspections are not only a property-level concern, but an issue that affects everyone living in the building. By highlighting the collective responsibility for fire safety, the survey sought to encourage residents to actively participate in the ongoing maintenance and improvement of fire prevention measures. It also aims to promote voluntary compliance with fire safety regulations, ensuring that all residents contribute to maintaining a safe living environment for everyone in the building.



## Sampling Approach

### Target Population

Target population refers to the group of individuals of the survey's interest. For this fire safety feedback survey, the target population includes all residents of residential buildings in Toronto that have undergone fire safety inspections within the last 12 months, varying in property type and geographic location within the city.

This diverse target population ensures a broad range of perspectives on fire safety measures, reflecting various living conditions across different areas of the city.



### Sampling Frame

The sampling frame or pool of potential respondents represents all the people in the population potentially to be sampled and invited to the survey [@howtorunsurveys]. In this research, the sampling frame will be based on a list of properties derived from inspection records. The survey will be distributed by contacting the building management or tenant associations of these properties, who will then send the surveys to the residents for completion. 

This process will be carried out in full compliance with privacy laws to ensure that residents' personal information is protected and that their participation remains confidential.



### Stratified Random Sampling

To ensure that the survey on fire safety compliance gathers reliable and representative data, a stratified random sampling method will be employed. The sampling approach follows the guidelines outlined in Survey Methodology [@surveymethodology].

This approach involves dividing the frame of population elements into meaningful subgroups, or "strata", which are "mutually exclusive groups of elements on a sampling frame" [@surveymethodology]. Then, separate samples are drawn from each stratum, using randomization techniques (e.g., random number generators) to select participants within each stratum. This approach helps ensure that the sample accurately reflects the diversity of the population.

The strata for this study will include the following categories:

- Region: The geographic address of the property, ensuring that different areas within Toronto are represented.

- Property Type: The occupancy type of the property, which includes various categories such as high-rise, low-rise, detention, group homes, group homes for vulnerable individuals (VO), hospitals, hotels & motels, nursing homes, residential care, and rooming houses.

This study plans to mount a survey collecting feedback on fire safety inspections of properties and expect that the results will vary across different property types and regions in Toronto. Therefore, the strata will be defined based on key characteristics relevant to building types and location information, ensuring that diverse perspectives are represented in the survey results.



### Planned Sample and Sample Size

The planned or target sample refers to all the people that ideally to be included to complete the survey [@howtorunsurveys].  

The sample size should be determined by balancing the need to achieve statistical significance with the constraints of available resources. After obtaining information about sample frame size, or the total number of residents across all strata, the proportion of the planned sample size allocated to each stratum should align with the proportion of that stratum in the overall target population. 

This approach ensures proportional representation from each stratum, reflecting the diversity of the population and improving the generalizability of the survey results. By maintaining this balance, the sample could provide a complete overview while meeting the constraints of available resources.



### Potential Errors

- Coverage Error

Coverage error refers to the difference between the potential pool of respondents and the target population [@howtorunsurveys], meaning that the sampling frame does not fully represent the target population.

In this research, the surveys will be distributed to residents using online Google Forms. However, since the recruitment relies on digital methods, there is a potential risk of underrepresentation in regions or property types where a majority of residents lack internet access or digital literacy. This could result in skewed data, with certain populations being less likely to participate.

Additionally, since the sampling frame is based solely on official building management contact information, residents in informal or unregistered housing arrangements may be excluded from the survey. This limitation could further affect the representativeness of the sample, as it excludes individuals living in non-official housing setups, who may also be affected by fire safety measures.

- Sampling Error

Sampling error refers to the difference between the planned sample and the sampling frame, that is, "the fact that you are drawing only a sample from the full sampling frame" [@howtorunsurveys]. 

In this research, despite the use of randomization, it is still possible that the selected individuals within a stratum do not accurately represent the overall stratum. This could occur due to the chance overrepresentation or underrepresentation of certain individuals. As a result, while randomization aims to minimize bias, sampling error could still influence the accuracy and precision of the findings.

- Non-response Error

Non-response error refers to the differences between the target sample and the actual sample [@howtorunsurveys]. 

In this research, error could arise if residents do not receive or notice the invitation of the survey. Since the surveys are distributed by building management or tenant associations through online platforms such as email, there is a risk that the survey invitations may be overlooked or filtered into spam folders. Email-based distribution depends on residents regularly checking their inboxes, and not all residents will do so. If the email is sent from an unfamiliar address or lacks clear identification, residents might dismiss it as junk or advertising mail, potentially ignoring it entirely. Furthermore, some email systems automatically filter certain messages into spam folders, reducing the visibility of the survey and limiting participation.

Additionally, residents may ignore the survey invitation due to a lack of immediate rewards or incentives for participation. Without clear incentives, such as gift cards or other tangible rewards, residents may not feel motivated to take the time to complete the survey. This lack of incentive could result in lower response rates, particularly among residents who do not understand the survey’s importance. As a result, the data collected might not fully capture the perspectives of all residents, leading to potential bias in the findings. 

More detailed discussion and potential solutions would be discussed in @sec-survey-bias.



## Survey

This survey will be conducted using Google Forms, which is an effective platform for data collection. It can be accessed by this link: [Google Form Survey](https://forms.gle/SMaPsDLVG1v33Ecy9).



### Survey Structure

**Title:**

Fire Safety Feedback Survey for Residential Properties in Toronto

**Introduction:**

We are conducting a survey to evaluate fire safety measures in your building following recent fire safety inspections conducted by Toronto Fire Services. 

Your feedback will help us assess the effectiveness of inspections, identify any ongoing safety concerns, and improve fire safety standards.

**Please note:**

- Your answers will all be treated with complete confidentiality and anonymity.

- Participation in this survey is voluntary.

- We encourage you to provide honest and thoughtful responses.

- The survey is estimated to take about 5 minutes to complete.

- If you have any questions or concerns, feel free to contact [kylie.gu@mail.utoronto.ca](kylie.gu@mail.utoronto.ca)  (Yunkai Gu).

Thank you for your valuable input. Your responses are essential for evaluating the outcomes and results of fire safety inspections by TFS.

**Section 1: Residential Building Information**

What is your city of residence?

- Toronto

- Other (End Survey)

What is your address? (Please specify to street number)

[Answer Box]

What is the occupancy type of your residential property?

- High Rise

- Low Rise

- Rooming House

- Group Home

- Group Home (VO)

- Hotels and Motels

- Detension

- Hospital

- Nursing Home

- Residential Cares

- Other [Answer Box]

- Unsure

What is your duration of residence? (Optional)

- Less than 1 year

- 1 to 3 years

- 3 to 5 years

- More than 5 years

**Section 2: Awareness of Fire Safety Inspection**

Were you aware that a fire safety inspection was recently conducted in your building?

- Yes

- No (Skip Next 2 Questions and Section 3)

If so, please indicate the source of awareness if available: (Optional; Select All That Apply)

- Notification from building management

- Signs posted in the building

- From neighbors/friends

- Other [Answer Box]

If so, please indicate the date of the inspection if available: (Optional; If you don't know, please leave the box blank.)

[Answer Box]

**Section 3: Improvements and Changes After Inspection**

Have you observed any improvements in fire safety facilities? (Select All That Apply)

- Fire alarms were tested or replaced.

- Emergency exits were cleared or repaired.

- Fire extinguishers were checked or replaced.

- Sprinkler systems were serviced.

- Other [answer box]

- No noticeable changes.

On a scale of 1 to 5, how effective do you think the changes have been in improving fire safety in your building?

[Scale 1-5]

Do you have any thoughts or suggestions regarding the fire safety inspection conducted by TFS? (Optional)

[Answer Box]

**Section 4: Current Fire Safety Conditions**

On a scale of 1 to 5, how confident are you in your building’s current compliance with fire safety standards?

[Scale 1-5]

How is the fire alarm functionality in your building?

- Fire alarms are always functional.

- Fire alarms are sometimes not functional.

- Fire alarms are often not functional.

- Fire alarms are always not functional.

- Unsure.

- Other [Answer Box]

Are the fire alarms in your building regularly tested?

- Yes

- No

- Unsure

How is the emergency exit accessibility in your building?

- Emergency exits are always accessible.

- Emergency exits are sometimes blocked or locked.

- Emergency exits are often blocked or locked.

- Emergency exits are always blocked or locked.

- Unsure

- Other [Answer Box]

How is the fire extinguisher functionality in your building?

- Fire extinguishers are always functional.

- Fire extinguishers are sometimes not functional.

- Fire extinguishers are often not functional.

- Fire extinguishers are always not functional.

- Unsure.

- Other [Answer Box]

Are fire extinguishers easily accessible and appear to be in working condition in your building?

- Yes

- No

- Unsure

How is the sprinkler system functionality in your building?

- Sprinkler systems are always functional.

- Sprinkler systems are sometimes not functional.

- Sprinkler systems are often not functional.

- Sprinkler systems are always not functional.

- Unsure.

- Other [Answer Box]

Are the sprinkler systems in your building regularly maintained?

- Yes

- No

- Unsure

Have you noticed any fire safety concerns in your building?

- Yes

- No

If so, please describe the fire safety concerns you noticed. (Optional)

[Answer Box]

**Section 5: Resident Experiences and Suggestions**

Have you participated in any activities related to fire safety organized by the building management (e.g. a fire emergency preparedness training in your building)?

- Yes

- No

Have you received any notifications from the building management regarding fire safety inspection and/or awareness?

- Yes

- No

Do you have any suggestions for enhancing fire safety in your building? (Optional)

 [Answer Box]
 
**End Message:**

Thank you for completing the Fire Safety Feedback Survey. Your responses will help us better evaluate the effectiveness of fire safety inspections by TFS, understand fire safety conditions in your residential building, and improve measures to protect residents like you.

If you have any further questions or concerns, please feel free to contact [kylie.gu@mail.utoronto.ca](kylie.gu@mail.utoronto.ca).



### Survey Design Considerations: Biases and Solutions {#sec-survey-bias}

The designing process of the survey is informed by the guidance provided in the paper “How to Run Surveys” [@howtorunsurveys]. The following considerations address the potential biases in the proposed resident feedback survey on fire safety compliance and suggest practical solutions:

- Response Bias

Response bias occurs when respondents "try to take short cuts to minimize the cognitive load" [@howtorunsurveys], which could lead to skewed results. This bias could also arise from how people process information based on the serial position of alternatives and their visual presentation. Common types of response bias include: moderacy biases, extreme response biases, and response order biases. In other words, respondents may consistently select moderate or extreme options, or may be influenced by the order in which options are presented.

Stefanie Stantcheva suggests that randomizing the order of response options for questions with unordered (nominal) response options would be one of the solutions to the response biases. Following this recommendation, the fire safety feedback survey has been designed to randomly arrange the order of options for questions related to functionality and accessibility of fire safety facilities in the buildings, as outlined in Section 4 in the survey. These questions follow a consistent structure and logic, making them particularly vulnerable to response biases due to the potential influence of the order in which options are presented. Randomizing the response options mitigates the effects of such biases, thereby enhancing the reliability of the data collected.

Stefanie Stantcheva also recommends avoiding long response lists, as they can overwhelm respondents and introduce bias. Therefore, most of the questions in the fire safety feedback survey are designed to avoid requiring respondents to read through extensive lists of alternatives and choices, unless necessary. This approach aims to enhance the clarity and reduce the stress respondents may feel when completing the survey. 

Additionally, balanced scales, such as a 5-point Likert scale with clear and evenly distributed options, could help reduce the negative effects of response bias by providing a range of numeric, direct choices to the respondents. Following this principle, the survey includes several scaled questions, such as "On a scale of 1 to 5, how effective do you think the changes have been in improving fire safety in your building?"

- Social Desirability Bias

Social Desirability Bias (SDB) typically stems from the desire of respondents to avoid embarrassment and project a favorable image to others, resulting in respondents not revealing their actual attitudes [@howtorunsurveys]. Respondents may provide answers they believe are socially acceptable or align with what they perceive the surveyor expects.

Stefanie Stantcheva suggests that by assuring respondents of complete anonymity in the survey, the social desirability biases could be mitigated, since emphasizing the confidentiality of responses would reduce pressure for the respondents and encourage more honest feedback.

Following this advice, the fire safety feedback survey includes special emphasis on anonymity in the introduction section, clearly informing respondents that their answers "will all be treated with complete confidentiality and anonymity." This assurance is intended to encourage honest and open responses, reducing the likelihood of respondents providing socially desirable answers instead of their true opinions.

This fire safety feedback survey also uses neutral wording and avoids leading questions. For instance, instead of asking, “Is the fire alarm working well?”, the survey asks, “How is the fire alarm functionality in your building?” This approach ensures that respondents are not influenced by biased or suggestive language, allowing them to provide more objective and accurate feedback based on their own observations and thoughts.

- Attrition or Non-response Bias

Not all residents will respond to the survey, and some may drop out midway, leading to missing data or biased outcomes. Attrition is a special case of non-response bias, which refers to the phenomenon of respondents dropping out of the study before completing it [@howtorunsurveys].

As recommended by Stefanie Stantcheva, the fire safety feedback survey is designed to provide a smooth respondent experience, ensuring that the survey is visually clear and user-friendly, which helps reduce dropout rates. The survey includes only necessary, non-complex questions to keep it concise and short, preventing respondents from feeling overwhelmed or impatient while completing it. By focusing on essential topics, the survey aims to encourage accurate responses without causing respondents to drop out. 

Stefanie Stantcheva also suggests the survey provide strong incentives for the respondents, in order to encourage respondents to complete the survey thoroughly and maximize participation. This could involve offering a variety of possible rewards that appeal to a broad range of people, helping to prevent both attrition and selection biases. 

If the budget allows, offering cash or gifts as rewards could further motivate the audience to participate, ensuring that the response rate remains high throughout the survey process.



# Additional Data Details {#sec-appx-data}

The dataset cleaning process for preparation follows several steps:

1. The column names are standardized to snake_case using `janitor` package for consistency and readability.

2. The date information in the 'inspections_closeddate' and  'inspection_opendate' columns are initially recorded in inconsistent format. The date information is processed and stored as a valid date type in the columns, either from the datetime (ymd_hms) or date-only (ymd) parsing using `lubridate` package.

3. The dataset is then filtered to keep only cases (rows) where inspection processes were closed during 2024, i.e. 'inspections_closeddate' is on or after January 1, 2024.

4. Time interval between the start date and end date of the inspection (i.e. difference in days between 'inspections_closeddate' and 'inspections_opendate') is calculated and stored as a new numeric column called 'date_num'.

5. A new column named 'violation' is created to indicate whether there was a violation being detected in the inspection case. If the 'violations_item_number' presents value of 0, 'violation' is set to 0; otherwise, it is set to 1.

6. Finally, only necessary column are selected and retained in the cleaned dataset: 'property_type', 'inspections_opendate', 'inspections_closeddate', 'date_num', and 'violation'.



# Model Details {#sec-model-details}

## Posterior Predictive Check {#sec-ppc}

During the modeling process, posterior predictive checks (PPC) are used.

PPC involves the comparison between what the fitted model predicts and the actual observed data, which validates whether the fitted model is compatible with the observed data. The aim is to detect if the model is inadequate to describe the data [@ppcheck]. This type of diagnostic visualizes the fit of the model by comparing the observed data ($y$) to the posterior predictive distributions ($y_{rep}$) generated by the model.

In this PPC plot, the X-axis represents predicted probability of the binary outcome $p_i$, which is the probability of observing violation for a property during the inspection. The Y-axis represents density or frequency of the predicted probabilities or aggregated counts.

The dark black line represents the distribution of the observed outcome ($y$), which is a smoothed estimate of the distribution of the binary response 'violation'. On the other hand, the light blue lines represent the posterior predictive simulations, which are the densities of the replicated data ($y_{rep}$) generated from the posterior predictive distribution of the fitted model.

Whether the black line matches well with the blue lines indicates how well the model fits the observed data. If the black line aligns closely with the blue lines, it suggests that the model is performing well in capturing the actual data distribution. Conversely, a significant mismatch would suggest that the model may not adequately describe the data.

@fig-ppcheck shows the posterior predictive checks for the Bayesian model.

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheck
#| fig-cap: "Posterior Prediction Check"

pp_check(model) +
  theme_classic() +
  theme(legend.position = "bottom")
```

The plot shows that the curves for $y$ (observed data) and $y_rep$ (posterior predictive distribution) align closely with each other, suggesting that the fix effects of two predictor variables capture the overall pattern of the observed data well, and the Bayesian model generates predictions that are consistent with the observed data. The lack of significant mismatches between the curves means that the model provides a good fit of data. Near extreme probabilities of 0 and 1, the two curves tightly follow each other, indicating that the model correctly predicts extreme outcomes.



## Posterior vs Prior {#sec-pvp}

Comparing the posterior distribution with the prior distribution is necessary for model validation. It examines how the model fits and is affected by the data.

The prior distribution represents beliefs about the parameter values before any data is observed, based on the initial assumptions. In the plot, it is represented by horizontal lines with points centered at the prior mean (in this case, 0) in the right panel.

The posterior distribution reflects updated beliefs about the parameters after observing the data. It is represented by points (means or medians), with colors representing the parameters respectively, and horizontal lines representing credible intervals derived from the data. The shorter the horizontal lines, the narrower the credible intervals, indicating that the uncertainty in the parameter estimation is reduced after incorporating the data.

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-posteriorvsprior
#| fig-cap: "Comparing the Posterior with the Prior"

posterior_vs_prior(model) +
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.text = element_text(size = 5)
  ) +
  coord_flip()
```


@fig-posteriorvsprior compares the posterior with the prior distribution of the Bayesian model, validating whether the data has a significant impact on the parameter estimates and whether the model is well-fit. 

In general, each level shows a narrower posterior distribution than the prior, reflecting that the uncertainty decreases and that the data provides substantial information to update the prior beliefs. Parameters with credible intervals far from zero in the posterior are strongly influenced by the data and have meaningful effects, such as the property types of 'Rooming House' (prprty_typRH) and 'Group Home' (prprty_typeGH).

As shown by the point representing the 'Intercept', the posterior credible interval is narrower than the prior, suggesting strong data support for it. The negative posterior mean indicates that the baseline log-odds of a violation for the reference property type (when $date_num = 0$) is below 0, implying a low probability of violation.

The posterior point for 'date_num' is very narrow and centered near 0, suggesting that the data indicates little or no effect of inspection duration on the log-odds of a violation. The credible interval includes 0, further reinforcing the lack of a strong relationship between 'date_num' and 'violation'.

Additionally, each property type coefficient represents the deviation in log-odds from the reference category, with the posterior distributions reflecting the impact of these property types on the likelihood of violations.

For example, the points representing 'Rooming House' (prprty_RH), 'High Rise' (prprty_HR), and 'Group Home' (prprty_GH), have posterior distribution above 0, suggesting that rooming houses, high-rise buildings and group homes are more likely to have violations than the reference category. The narrow credible intervals indicate strong data support for these relationships.

On the other hand, the point representing 'Nursing Home' (prprty_NH) has a posterior close to 0, suggesting that its effect is small or negligible compared to the reference category. Despite this, the narrow credible intervals still indicate strong data support for the estimate, confirming the model’s confidence in the result.

The rest of dots representing different levels of 'property type' show varying posterior means and credible intervals. Most of the points are either close to 0 or above 0, providing information about effects of different property types on the likelihood of violations respectively. These values reflect how each property type deviates from the reference category in terms of log-odds, with the credible intervals offering a measure of uncertainty around the estimates.



## Diagnostics {#sec-diagnostics}

### Trace Plot

The trace plot shows samples from all the chains. 

In the trance plot, the X-axis represents the iteration numbers of the MCMC progress (in this case, up to 4,000 iterations per chain), while the Y-axis displays the sampled values of the posterior distribution for each parameter. Each MCMC chain used during sampling is represented by a different color.

If all chains appear to oscillate around the same mean and overlap significantly, it suggests that the parameter estimates are stable around a consistent mean. It is also a positive sign if the chains overlap in most regions and move freely across the posterior distribution. Additionally, there should be no systematic patterns, trends or large jumps.

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-trace
#| fig-cap: "Checking the Convergence of the MCMC Algorithm by Trace Plot"

plot(model, "trace") +
    theme(
          axis.text.x = element_text(size = 7),
          axis.text.y = element_text(size = 5),
          legend.title = element_text(size = 12),
          legend.text = element_text(size = 10),
          legend.position = "bottom",
          strip.text = element_text(size = 6)
    )
```


@fig-trace shows the trace plot for the Bayesian model used in this paper. The chains for all parameters appear to mix well, with no signs of one chain dominating or exploring a different region of the parameter space. The parameters, especially 'Intercept' and 'date_num', show overlapping chains, which is a positive sign of convergence.

Moreover, most chains are stabilized and oscillate around a consistent mean. This consistent behavior across iterations indicates that the chains have reached stationarity. Also, there are no visible divergences or chain-specific trends, suggesting that the sampling process is functioning correctly.

In general, the trace plots suggest that MCMC chains have converged, supported by good mixing, stationarity, and consistent sampling across chains. This indicates that the posterior estimates for all parameters are likely reliable. If there is any slight variability observed, it could be addressed by additional iterations, which would help gather more independent samples and further stabilize the results.



### R-hat Plot

$\hat{R}$ is a diagnostic measure that compares the variance within each chain to the variance between chains. This diagnostic plot is used to asses the convergence of MCMC chains. Ideally, the $\hat{R}$ should be close to 1, indicating that the chains have mixed well and are sampling from the same posterior distribution. For $\hat{R} \leq 1.5$, we could consider convergence to be acceptable, meaning that the chains are producing reliable parameter estimates.

@fig-rhat is the R-hat plot for the Bayesian model used in this paper. The plot shows that the R-hat values for all parameters are below 1.05, suggesting that the chains have converged well and are sampling effectively from the posterior distribution. With R-hat values within this range, the posterior samples are likely reliable for inference, indicating that the results could be confidently used for interpreting parameter estimates.

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-rhat
#| fig-cap: "Checking the Convergence of the MCMC Algorithm by Rhat Plot"

plot(model, "rhat")
```




\newpage




# References


